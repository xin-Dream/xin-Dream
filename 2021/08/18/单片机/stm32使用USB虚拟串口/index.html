<!DOCTYPE html>
<html>

    <head>
        <title>
            DreamCube
                ZGX
        </title>
        <meta charset="utf-8">

        <!-- 引入配置文件 -->
        
<link rel="stylesheet" href="/CSS/main.css">

        <!-- 字体图片库 -->
        
<link rel="stylesheet" href="/lib/font-awesome/css/font-awesome.min.css">

        <!-- 代码高亮库 -->
        
<link rel="stylesheet" href="/lib/highlight/styles/atom-one-light.css">


    <meta name="generator" content="Hexo 5.3.0">
<style>.github-emoji { position: relative; display: inline-block; width: 1.2em; min-height: 1.2em; overflow: hidden; vertical-align: top; color: transparent; }  .github-emoji > span { position: relative; z-index: 10; }  .github-emoji img, .github-emoji .fancybox { margin: 0 !important; padding: 0 !important; border: none !important; outline: none !important; text-decoration: none !important; user-select: none !important; cursor: auto !important; }  .github-emoji img { height: 1.2em !important; width: 1.2em !important; position: absolute !important; left: 50% !important; top: 50% !important; transform: translate(-50%, -50%) !important; user-select: none !important; cursor: auto !important; } .github-emoji-fallback { color: inherit; } .github-emoji-fallback img { opacity: 0 !important; }</style>
<link rel="alternate" href="/atom.xml" title="Dream" type="application/atom+xml">
</head>

    <header>
        <span class="name">DreamCube </span>
        <div class="options">
            <a href="Home.html">首页</a>
            <a href="paging/control.html">..</a>
            <a href="paging/code.html">..</a>
            <a href="paging/debug.html">..</a>
            <a href="paging/explanation.html">..</a>
        </div>          
    </header>

    <body>


        <div class="home_container">

            <div id="home_content">
                <div id="home_con_top">
                    <h1>Dream</h1>
                    <h1>怕什么真理无穷，进一寸有一寸的欢喜</h1>
                </div>
                <div id="home_introduction">
                    <div>
    <span id="post-author">作者: ZGX</span>
    <span id="post-date">2021-08-18 16:59:50</span>
</div>

<div id="article">
    <blockquote>
<p>环境说明<br>stm32CubeMX、Clion、Windows10、Ubuntu18.04</p>
</blockquote>
<h1 id="一、在clion中新建stm32项目"><a href="#一、在clion中新建stm32项目" class="headerlink" title="一、在clion中新建stm32项目"></a>一、在clion中新建stm32项目</h1><p>此处参考另一篇文章<a href="/2021/06/14/%E5%8D%95%E7%89%87%E6%9C%BA/%E9%85%8D%E7%BD%AECLion%E5%BC%80%E5%8F%91stm32/" title="配置CLion开发stm32">配置CLion开发stm32</a></p>
<h1 id="二、stm32CubeMX中的配置"><a href="#二、stm32CubeMX中的配置" class="headerlink" title="二、stm32CubeMX中的配置"></a>二、stm32CubeMX中的配置</h1><ol>
<li><p>基础配置</p>
<ul>
<li>SystemCore -&gt; RCC -&gt; HSE -&gt; Crystal/Ceramic Resonator</li>
<li>SYS -&gt; Debug -&gt; Serial Wire</li>
<li>在Clock Configuration中设置需要的频率</li>
</ul>
</li>
<li><p>USB设置<br>(1) Connectivity -&gt; USB_OTG_FS -&gt; Mode -&gt; Device_Only<br>(2) Middleware -&gt; USE_DEVICE -&gt; Class For FS IP -&gt; Communication Device Class(Virtual Port Com)</p>
</li>
<li><p>设置完成后生成代码</p>
<p> GENERATE CODE</p>
</li>
</ol>
<h1 id="三、程序中测试"><a href="#三、程序中测试" class="headerlink" title="三、程序中测试"></a>三、程序中测试</h1><p>回到Clion中修改程序，注意自己添加的内容要放在每个BEGIN和END中，这样在CubeMX中再次生成代码后自己修改的内容不会被覆盖掉。</p>
<pre><code class="C">// 在main.c中修改修改代码

// 在以下标志中间添加头文件
/* USER CODE BEGIN Includes */

//测试用的CDC函数在下列函数中有定义
#include "usbd_cdc_if.h"

/* USER CODE END Includes */


// 在main函数中添加以下程序测试
unsigned char buff[4] = {"hello"};

while (1)
{
/* USER CODE END WHILE */    

HAL_Delay(1000);
CDC_Transmit_FS(buff,4);

/* USER CODE BEGIN 3 */
}
</code></pre>
<p>在前面生成代码后会生成一个USB_DEVICE文件夹，在usbd_cdc_id.c中定义的是CDC信息处理的函数，CDC_Receive_FS、CDC_Transmit_FS、CDC_TransmitCplt_FS等，这都是可自定义的函数代码，需要时可以自己修改。</p>
<h1 id="四、在Ubuntu-windows中使用串口测试"><a href="#四、在Ubuntu-windows中使用串口测试" class="headerlink" title="四、在Ubuntu/windows中使用串口测试"></a>四、在Ubuntu/windows中使用串口测试</h1><ol>
<li>Ubuntu</li>
</ol>
<pre><code class="bash"># 使用USB线连接stm32与Ubuntu后在终端输入命令
lsusb
# 若连接成功，会显示USB的ID号和名称。这里的名称是我们在CubeMX中可以设置的
# 这些信息我们在以后串口绑定时会用到

# 一个不错的有界面的串口调试工具
sudo apt install cutecom

# 在cutecom中可以方便的操作，类似于windows中的XCOM，正常情况下可以显示程序中输出的字符串 </code></pre>
<ol start="2">
<li><p>Windows</p>
<p> 使用XCOM查看</p>
</li>
</ol>

</div>
  
                </div>
            </div>

        </div>
        

        <!-- 引入 jquery -->
        
<script src="/lib/jQuery.min.js"></script>


        <!-- 引入代码高亮的 js -->
        
<script src="/lib/highlight/highlight.pack.js"></script>


        <!-- 引入 pjax -->
        
<script src="/lib/jquery.pjax.js"></script>


        <!-- 引入 js 文件 -->
        
<script src="/js/main.js"></script>




    </body>
    <footer class="footer">
        <span style="font-size: 20px; font-family: '楷体';color: gray;">青岛科技大学 机器人研发中心 张桂新</span>
    </footer>

</html>