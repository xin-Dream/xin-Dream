---
title: 武术擂台机器人
date: 2021-07-14 15:07:22
tags: 项目
categories: [项目规划]
password: qust2021

message: 输入密码，查看文章
---
# 一、武术擂台机器人
<details>
    <summary>设计结构框架：点击查看详细内容</summary>
        <li><input disabled="" type="checkbox"> 结构设计
            <ul>
                <li><input checked="" disabled="" type="checkbox"> 钣金结构设计</li>
                <li><input checked="" disabled="" type="checkbox"> 固定传感器支架</li>
                <li><input disabled="" type="checkbox"> 车内电路板固定支撑板</li>
                <li><input disabled="" type="checkbox"> 电池固定与缓冲</li>
                <li><input disabled="" type="checkbox"> 电机抗磁干扰结构设计</li>
            </ul>
        </li>
        <li><input disabled="" type="checkbox"> 电路设计
            <ul>
                <li><input checked="" disabled="" type="checkbox"> 24V、12V、5V、3.3V稳压电路</li>
                <li><input disabled="" type="checkbox"> 基于IR2184的电机驱动电路</li>
                <li><input disabled="" type="checkbox"> 短路保护与过载保护</li>
                <li><input checked="" disabled="" type="checkbox"> 信号隔离电路</li>
                <li><input disabled="" type="checkbox"> 基于电路的环向传感器方向分辨电路</li>
            </ul>
        </li>
        <li><input disabled="" type="checkbox"> 基于FreeRTOS的程序框架设计
            <ul>
                <li><input checked="" disabled="" type="checkbox"> 调试功能设计
                    <ul>
                        <li><input checked="" disabled="" type="checkbox"> 蓝牙通信</li>
                        <li><input checked="" disabled="" type="checkbox"> OLED显示</li>
                        <li><input disabled="" type="checkbox"> SD卡读取</li>
                    </ul>
                </li>
                <li><input disabled="" type="checkbox"> 传感层
                    <ul>
                        <li><input checked="" disabled="" type="checkbox"> DMA读取ADC数据</li>
                        <li><input disabled="" type="checkbox"> 读取编码器数值</li>
                        <li><input disabled="" type="checkbox"> 读取电机驱动电流</li>
                        <li><input disabled="" type="checkbox"> 电机基本控制</li>
                    </ul>
                </li>
                <li><input disabled="" type="checkbox"> 感知层
                    <ul>
                        <li><input checked="" disabled="" type="checkbox"> 数据分类与冗余数据的简单融合</li>
                        <li><input checked="" disabled="" type="checkbox"> 基于程序的环向传感器方向分辨</li>
                        <li><input disabled="" type="checkbox"> 基于三角形布置灰度传感器的位置感知</li>
                        <li><input disabled="" type="checkbox"> 落台检测与方向判断</li>
                        <li><input disabled="" type="checkbox"> 登台位置选择</li>
                    </ul>
                </li>
                <li><input disabled="" type="checkbox"> 决策层
                    <ul>
                        <li><input disabled="" type="checkbox"> 巡航</li>
                        <li><input checked="" disabled="" type="checkbox"> 寻找敌人</li>
                        <li><input disabled="" type="checkbox"> 对抗</li>
                        <li><input disabled="" type="checkbox"> 使用概率法的对敌人位置预估</li>
                    </ul>
                </li>
            </ul>
        </li>
  <!-- <pre><code>title，value，callBack可以缺省</code></pre> -->
</details>

# 前言

武术擂台机器人本是基于中国机器人智能创意大赛中开放部件组设计的，在前三届中开放部件组的规则是由蓝黄两方机器人对撞，通过将敌方推下台得分。但今年规则有所改动，在由中心向四周呈放射状由浅灰变黑色的擂台上，有三个不同颜色的能量块，分别表示己方与敌方，推下台有相应加减分，具体见规则。

编者目的在于尽量多的表达出自己在武术擂台机器人设计中遇到的问题与启示，对重要点会进行标注。后续读者应大多为青岛科技大学机器人研发中心成员，希望各位仔细阅读，注意重要标注点。

> 标注点格式

由于编者能力有限，文中纰漏希望各位在评论区指正！

# 功能分析

> 对任一机器人或机械设备的设计，首先应考虑其应具备的功能、工作的环境与设备的成本。故首先对武术擂台机器人进行功能分析，初步选用相应的零部件。

</br></br>
+ 武术擂台机器人在攻击对方时，应有足够的扭力与敌方对抗（电机扭力与电机驱动的堵转电流）
+ 机器人应有一定能力保证自己不落下台（底面为放射状颜色由浅变深--灰度传感器且能判断方向）
+ 机器人在落台后应有能力返回台上（找到登台位置--角度传感器）
+ 机器人应能识别到靠近物体为能量块还是敌方机器人（视觉模块或颜色传感器）


# 电路结构设计

# 机械结构设计

# 程序结构设计

单片机中的程序应能迅速处理传感器中反馈的数据，结合传感器数据分析当下机器人位置与状态并根据不同状态做出响应。

本人主要设计的为基于Stm32F407的轮询模式程序与基于Stm32F407的FreeRTOS，本文中主要对后一种程序模式介绍。
</br></br>
> 这里要注意一点，我个人认为当下机器人相关教育与基础知识发展迅速，后面同学对机器人的学习不应盲目遵循往届学长的模式，由51学到stm32，再去学习ROS等高级操作系统。同学们针对实验室中魔方机器人、武术擂台机器人、ROS智能机器人等其中一项，搞明白原理，将学长的内容由自己实现一遍，才是扎实掌握知识的方式。
</br></br>

根据程序特征，对单片机中的程序选用FreeRTOS，即实时操作系统。
对FreeRTOS的学习请参考作者另一系列的文章。本文主要介绍武术擂台机器人的程序结构具体实现与FreeRTOS的实际应用。

## 1. 程序中变量管理与结构体的使用

## 2. DMA读取灰度传感器与红外激光测距传感器的ADC数据

## 3. 串口读取IMU数据

## 4. OLED屏幕中显示相应数据

## 5. 电机运动控制

## 6. 蓝牙控制在调试中的使用 

## 7. 对传感器数据进行融合并反馈出机器人位置与当下状态



# 设计新思路

1. 将传感器数据或电机数据或处理后的数据通过文件管理的形式写入SD卡，在一定频率下写入，后续在Matlab中处理，分析运动状态，对机器人的运动模型进行分析。

2. 要使用SD卡需将当下定义中的部分IO口修改，所以电路设计中，主控制集成板的设计应重新规划

3. 在电机驱动的设计中加入电流反馈与堵转保护，便于控制模型的设计

4. 使用Wi-Fi模块搭建局域网，两单片机通信，规定相应的通讯协议。一单片机在车上读取传感器数据并发出，同时接受电机控制信号并实现对电机的控制，另一单片机负责接收传感器数据并处理，发出运动信号。这样车在台上，处理数据的单片机连接至电脑，避免调试过程中反复修改机器人中程序。






